# ELM_Practice

# Elm実習 まとめ

DragDrop.txtの内容はTryElmにコピー&ペーストすることにより実行可能

TryElmは以下のリンクから利用可能<br>
[Try Elm](https://elm-lang.org/)

## 手順

Elm言語を利用して図形をドラッグ&ドロップするプログラムを作成する。<br>
そのプログラム完成を目標とした実行手順を以下に示す。<br>

・TryElmの利用<br>
・サンプルコード読解<br>
・プログラム作成(Playground)<br>
・プログラム作成(browser.sandbox)<br>
※合間に必要に応じてElm言語についての調査<br>

<br>

## TryElmの利用
TryElmはオンラインでElm言語を実行できるサービスである。PCにインストールする必要が無く、サイトを開いてすぐにプログラムの記入・実行を行うことができる。また、サイト内にはElmのサンプルコードやヘルプもあり、私のような初心者にとってもスムーズにElm言語の基礎を理解することができる。<br>

## サンプルコード読解
TryElm内のexamplesにまとめられているサンプルコードより、HTML、User Input、Random、Time、Playgroundの読解を行った。<br>
Elm言語がどのようなものかを知るだけでなく、その言語をどのように使用するとどのようなことができるのかを、複数のサンプルから理解する。<br>
基本的にはmain関数に対してinit、update、viewの3つの関数で構成されているので、それさえ踏まえれば簡単なプログラムを作成することが可能となる。<br>

## プログラム作成(Playground)
サンプルコードのPlaygroundにマウスカーソルの座標を利用したプログラムがあったため、そのプログラムを引用してドラッグ&ドロップのプログラムを作成した。目標のプログラムを完成させるために、必要な要素を追加する形でプログラムを更新していく。その手順を以下に示す。<br>
・図形がマウスカーソルに付いてくる(元のプログラム)<br>
・左クリック時のみ図形がマウスカーソルに付いてくる<br>
　左クリックの処理・判定を追加。<br>
・図形の座標を維持<br>
　左クリックを離した時、その位置に図形が留まるように処理。<br>
・図形をマウスカーソルで掴む位置の固定<br>
　図形をクリックした位置がドラッグ時にも変動しないように処理。<br>
　詳細は後述。<br>
・図形をドラッグ&ドロップする<br>
　図形を左クリックする判定を追加。<br>


## プログラム作成(browser.sandbox)
HTML形式でも実行できるように、Browserモジュールを利用したプログラムも作成する。完成したプログラムがDragDrop.txtである。前のプログラム作成時とほぼ同じ手順でプログラムを作成した。ただし、図形のマウスカーソルへの追従の処理方法を変更したので以下に記す。この変更により処理が多少スムーズになった。<br>

### Playgroundプログラム作成時の場合
　マウスカーソルの座標のドラッグ前(変数mouse)とドラッグ中から距離を計り(変数move)、図形の座標(変数circle)に加算する。ドロップ時、現在の図形の座標を変数circleに入れる。**ドラッグ中はマウスカーソルと同じように図形も動く。**<br>
![](https://i.imgur.com/87dwlrT.png)

### Htmlプログラム作成時の場合
　ドラッグ前はマウスカーソルと図形の座標の距離(変数offsetX,offsetY)を随時変更させ、ドラッグ中はその距離の値を変更せず、マウスカーソルからその距離移動させた座標に図形を描画する。**ドラッグ中にマウスカーソルと図形の位置関係は変わらない。**<br>
![](https://i.imgur.com/tj1V03a.png)
